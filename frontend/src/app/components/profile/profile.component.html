<div class="profile-page">
  <div class="background-shapes">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>
  
  <div class="profile-container">
    
    <!-- Left Column: Identity Card -->
    <div class="identity-card" *ngIf="user">
      <div class="avatar-wrapper">
        <div class="avatar">
          {{ user.username.charAt(0).toUpperCase() }}
        </div>
        <div class="online-indicator"></div>
      </div>
      
      <h2 class="username">{{ user.username }}</h2>
      <p class="role-tag">Member since {{ getCurrentYear() }}</p>
      
      <div class="stats-row">
        <div class="stat">
          <span class="stat-num">{{ user.id }}</span>
          <span class="stat-label">User ID</span>
        </div>
        <div class="stat-divider"></div>
        <div class="stat">
          <span class="stat-num">Active</span>
          <span class="stat-label">Status</span>
        </div>
      </div>
      
      <button class="btn-edit" (click)="toggleEdit()">
        {{ editMode ? 'Cancel Editing' : 'Edit Profile' }}
      </button>
    </div>

    <!-- Right Column: Details & Edit Form -->
    <div class="details-card">
      <h3 class="card-title">{{ editMode ? 'Edit Information' : 'Personal Details' }}</h3>
      
      <!-- View Mode -->
      <div class="info-grid" *ngIf="!editMode && user">
        <div class="info-group">
          <label>Username</label>
          <div class="info-value">{{ user.username }}</div>
        </div>
        
        <div class="info-group">
          <label>Email Address</label>
          <div class="info-value">{{ user.email }}</div>
        </div>
        
        <div class="info-group">
          <label>Full Name</label>
          <div class="info-value">{{ user.firstName }} {{ user.lastName }}</div>
        </div>
        
        <div class="info-group">
          <label>Mobile Number</label>
          <div class="info-value">{{ user.mobileNumber || 'Not set' }}</div>
        </div>
        
        <div class="info-group full-width">
          <label>Address</label>
          <div class="info-value">{{ user.address || 'Not set' }}</div>
        </div>

        <div class="info-group full-width">
          <label>Role</label>
          <div class="role-badges">
            <span class="badge" *ngFor="let role of user.roles">{{ role.replace('ROLE_', '') }}</span>
          </div>
        </div>
      </div>

      <!-- Edit Mode -->
      <div class="edit-form" *ngIf="editMode">
        <div class="form-grid">
          <div class="form-group">
            <label>First Name</label>
            <input type="text" [(ngModel)]="updateData.firstName" placeholder="Enter first name">
          </div>
          <div class="form-group">
            <label>Last Name</label>
            <input type="text" [(ngModel)]="updateData.lastName" placeholder="Enter last name">
          </div>
          <div class="form-group">
            <label>Mobile Number</label>
            <input type="text" [(ngModel)]="updateData.mobileNumber" placeholder="Enter mobile number">
          </div>
          <div class="form-group full-width">
            <label>Address</label>
            <textarea [(ngModel)]="updateData.address" rows="3" placeholder="Enter your address"></textarea>
          </div>
        </div>
        
        <div class="form-actions">
          <button class="btn-save" (click)="saveProfile()" [disabled]="loading">
            {{ loading ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>
      </div>

      <!-- Loading & Error -->
      <div class="loading-overlay" *ngIf="loading">
        <div class="spinner"></div>
      </div>
      
      <div class="error-banner" *ngIf="error">
        {{ error }}
        <button (click)="load()">Retry</button>
      </div>
    </div>
    
  </div>
</div>