<div class="checkout-wrapper">
  <div class="checkout-container">
    <h1 class="checkout-title">Secure Checkout</h1>

    <div class="checkout-grid">
      <!-- Left Column - Form -->
      <div class="checkout-form-section">
        <form [formGroup]="checkoutForm">
          <!-- Shipping Information -->
          <div class="form-card">
            <h2 class="section-title">
              <i class="bi bi-truck"></i>
              Shipping Information
            </h2>

            <div class="form-row">
              <div class="form-group">
                <label for="firstName">First Name *</label>
                <input type="text" id="firstName" formControlName="firstName" class="form-input" placeholder="John">
                <small class="error-message"
                  *ngIf="checkoutForm.get('firstName')?.errors?.['required'] && checkoutForm.get('firstName')?.touched">
                  First name is required
                </small>
              </div>
              <div class="form-group">
                <label for="lastName">Last Name *</label>
                <input type="text" id="lastName" formControlName="lastName" class="form-input" placeholder="Doe">
                <small class="error-message"
                  *ngIf="checkoutForm.get('lastName')?.errors?.['required'] && checkoutForm.get('lastName')?.touched">
                  Last name is required
                </small>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" formControlName="email" class="form-input"
                  placeholder="john@example.com">
                <small class="error-message"
                  *ngIf="checkoutForm.get('email')?.errors?.['required'] && checkoutForm.get('email')?.touched">
                  Email is required
                </small>
              </div>
              <div class="form-group">
                <label for="phone">Phone Number *</label>
                <input type="tel" id="phone" formControlName="phone" class="form-input" placeholder="1234567890">
                <small class="error-message"
                  *ngIf="checkoutForm.get('phone')?.errors?.['required'] && checkoutForm.get('phone')?.touched">
                  Phone number is required
                </small>
                <small class="error-message"
                  *ngIf="checkoutForm.get('phone')?.errors?.['pattern'] && checkoutForm.get('phone')?.touched">
                  Phone must be 10 digits
                </small>
              </div>
            </div>

            <div class="form-group">
              <label for="address">Address *</label>
              <input type="text" id="address" formControlName="address" class="form-input"
                placeholder="123 Main Street">
              <small class="error-message"
                *ngIf="checkoutForm.get('address')?.errors?.['required'] && checkoutForm.get('address')?.touched">
                Address is required
              </small>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="city">City *</label>
                <input type="text" id="city" formControlName="city" class="form-input" placeholder="New York">
                <small class="error-message"
                  *ngIf="checkoutForm.get('city')?.errors?.['required'] && checkoutForm.get('city')?.touched">
                  City is required
                </small>
              </div>
              <div class="form-group">
                <label for="state">State *</label>
                <input type="text" id="state" formControlName="state" class="form-input" placeholder="NY">
                <small class="error-message"
                  *ngIf="checkoutForm.get('state')?.errors?.['required'] && checkoutForm.get('state')?.touched">
                  State is required
                </small>
              </div>
              <div class="form-group">
                <label for="zipCode">ZIP Code *</label>
                <input type="text" id="zipCode" formControlName="zipCode" class="form-input" placeholder="10001">
                <small class="error-message"
                  *ngIf="checkoutForm.get('zipCode')?.errors?.['required'] && checkoutForm.get('zipCode')?.touched">
                  ZIP code is required
                </small>
              </div>
            </div>
          </div>

          <!-- Payment Method -->
          <div class="form-card">
            <h2 class="section-title">
              <i class="bi bi-credit-card"></i>
              Payment Method
            </h2>
            <div class="payment-methods">
              <label class="payment-option" *ngFor="let method of paymentMethods">
                <input type="radio" [value]="method" formControlName="paymentMethod">
                <span class="payment-label">{{ method }}</span>
              </label>
            </div>
          </div>

          <!-- Terms & Conditions -->
          <div class="form-card">
            <label class="checkbox-container">
              <input type="checkbox" id="agreeTOS" formControlName="agreeTOS">
              <span class="checkbox-label">I agree to the terms and conditions *</span>
            </label>
            <small class="error-message"
              *ngIf="checkoutForm.get('agreeTOS')?.errors?.['required'] && checkoutForm.get('agreeTOS')?.touched">
              You must agree to terms and conditions
            </small>
          </div>

          <!-- Action Buttons -->
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="goBack()">
              <i class="bi bi-arrow-left"></i> Back to Cart
            </button>
            <button type="button" class="btn btn-primary" (click)="proceedToPayment()" [disabled]="!checkoutForm.valid">
              Proceed to Payment <i class="bi bi-arrow-right"></i>
            </button>
          </div>
        </form>
      </div>

      <!-- Right Column - Order Summary -->
      <div class="order-summary-section">
        <div class="summary-card">
          <h2 class="summary-title">Order Summary</h2>

          <!-- Cart Items -->
          <div class="summary-items">
            <div class="summary-item" *ngFor="let item of cartItems">
              <div class="item-details">
                <div class="item-icon">ðŸ“¦</div>
                <div class="item-info">
                  <p class="item-name">{{ item.productName }}</p>
                  <p class="item-qty">Qty: {{ item.quantity }}</p>
                </div>
              </div>
              <p class="item-price">â‚¹{{ (item.price || 0) * item.quantity | number:'1.0-0' }}</p>
            </div>
          </div>

          <!-- Coupon Section -->
          <div class="coupon-section">
            <h3 class="coupon-title">
              <i class="bi bi-tag"></i> Have a Coupon?
            </h3>

            <div class="coupon-input-group" *ngIf="!appliedCoupon">
              <input type="text" [(ngModel)]="couponCode" [ngModelOptions]="{standalone: true}" class="coupon-input"
                placeholder="Enter coupon code" [disabled]="isApplyingCoupon">
              <button class="coupon-btn" (click)="applyCoupon()" [disabled]="isApplyingCoupon">
                {{ isApplyingCoupon ? 'Applying...' : 'Apply' }}
              </button>
            </div>

            <div class="coupon-applied" *ngIf="appliedCoupon">
              <div class="coupon-badge">
                <i class="bi bi-check-circle"></i>
                <span>{{ appliedCoupon.code }} applied!</span>
              </div>
              <button class="coupon-remove" (click)="removeCoupon()">
                <i class="bi bi-x"></i>
              </button>
            </div>

            <p class="coupon-error" *ngIf="couponError">
              <i class="bi bi-exclamation-circle"></i> {{ couponError }}
            </p>
            <p class="coupon-success" *ngIf="couponSuccess">
              <i class="bi bi-check-circle"></i> {{ couponSuccess }}
            </p>
          </div>

          <!-- Price Breakdown -->
          <div class="price-breakdown">
            <div class="price-row">
              <span>Subtotal:</span>
              <span>â‚¹{{ subtotal | number:'1.0-0' }}</span>
            </div>
            <div class="price-row discount-row" *ngIf="discount > 0">
              <span>Discount:</span>
              <span class="discount-amount">- â‚¹{{ discount | number:'1.0-0' }}</span>
            </div>
            <div class="price-row total-row">
              <span>Total:</span>
              <span class="total-amount">â‚¹{{ total | number:'1.0-0' }}</span>
            </div>
          </div>

          <!-- Security Badge -->
          <div class="security-badge">
            <i class="bi bi-shield-check"></i>
            <span>Secure Checkout</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>